<!doctype html>
  <script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

<html style="font-size: 16px;" lang="en"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Post 1 Headline">
    <meta name="description" content="">
    <title>Graph neural network</title>
    <link rel="stylesheet" href="../nicepage.css" media="screen">
<link rel="stylesheet" href="../Post-Template.css" media="screen">
    <script class="u-script" type="text/javascript" src="../jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="../nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 4.14.1, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "",
		"logo": "images/owanlogo.png",
		"sameAs": [
				"https://www.facebook.com/owan.naruemit",
				"https://twitter.com/napanaruemit",
				"https://www.linkedin.com/in/pethai-napanaruemit-3a69a7190/",
				"https://github.com/pethai2004",
				"https://www.youtube.com/channel/UCkQZQFB-PPBgNEL-GizSucw"
		]
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta name="twitter:site" content="@">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Post Template">
    <meta name="twitter:description" content="">
  </head>
  <body class="u-body u-xl-mode" data-lang="en"><header class=" u-clearfix u-header u-section-row-container" id="sec-b8de"><div class="u-section-rows">
        <div class="u-clearfix u-palette-2-light-1 u-section-row u-section-row-1" data-animation-name="" data-animation-duration="0" data-animation-delay="0" data-animation-direction="" id="sec-f7ac">
          <div class="u-clearfix u-sheet u-valign-middle-lg u-valign-middle-md u-valign-middle-sm u-valign-middle-xl u-sheet-1">
            <a href="../Home.html" data-page-id="208602995" class="u-image u-logo u-image-1" data-image-width="1000" data-image-height="1000" title="Home">
              <img src="../images/owanlogo.png" class="u-logo-image u-logo-image-1">
            </a>
            <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
              <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px; font-weight: 700;">
                <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#" style="padding: 4px 42px; font-size: calc(1em + 8px);">
                  <svg class="u-svg-link" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
                  <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</g></svg>
                </a>
              </div>
              <div class="u-custom-menu u-nav-container">
                <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="../Home.html" style="padding: 10px 20px;">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="../project-and-code.html" style="padding: 10px 20px;">project and code</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="../lecture.html" style="padding: 10px 5px 10px 20px;">lecture</a>
</li></ul>
              </div>
              <div class="u-custom-menu u-nav-container-collapse">
                <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
                  <div class="u-inner-container-layout u-sidenav-overflow">
                    <div class="u-menu-close"></div>
                    <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../Home.html">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../project-and-code.html">project and code</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../lecture.html">lecture</a>
</li></ul>
                  </div>
                </div>
                <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
              </div>
            </nav>
          </div>
          
          
          
          
          
        </div>
        <div class="u-section-row u-section-row-2" id="sec-e839">
          <div class="u-clearfix u-sheet u-sheet-2"></div>
          
          
          
          
          
        </div>
      </div></header>
    <section class="u-align-center u-clearfix u-section-1" id="sec-bf54">
      <div class="u-clearfix u-sheet u-valign-middle-md u-valign-middle-sm u-valign-middle-xs u-sheet-1"><!--post_details--><!--post_details_options_json--><!--{"source":""}--><!--/post_details_options_json--><!--blog_post-->
        <div class="u-container-style u-expanded-width u-post-details u-post-details-1">
          <div class="u-container-layout u-valign-middle u-container-layout-1", style= "position: center;padding: 0px 100px 5px 100px;"><!--blog_post_image-->
            <!--/blog_post_image--><!--blog_post_header-->
            <h2 class="u-blog-control u-text u-text-1">Graph neural network</h2><!--/blog_post_header--><!--blog_post_metadata-->
            <div class="u-blog-control u-metadata u-metadata-1"><!--blog_post_metadata_date-->
              <span class="u-meta-date u-meta-icon">Oct 29, 2022</span><!--/blog_post_metadata_date--><!--blog_post_metadata_category-->
              <!--/blog_post_metadata_category--><!--blog_post_metadata_comments-->
              <!--/blog_post_metadata_comments-->

            </div><!--/blog_post_metadata--><!--blog_post_content-->
<div style= "position: center;">
<h4>Graph Neural Network</h4>
<p>
Many applications involve the expressivity of graph data structure such as molecular network and is  described in unique non-Euclidean data structure. The model based on graph network can be collectively aggregate information from its topological structure, as well as the dependency between each node. An image, for instance, consists of high-dimensional structure yet can be represented by representative graph which gather its topological dependency such as eyes and mouse are interconnected. 
</p>
<p>
Graph, in general, can by directed: all edges are directed from one node to others, and undirected: can be regard as two directed graph. Other catagorization is the nodes and edges types; homogeneous graph-a graph in which all element of the graph is of the same type; heterogeneous is when graph element is not the same type for nodes and edges. The graph can all so be dynamical which is when the input features or topological structure of the graph vary with respect to time. For example, in subsampling of the graph to make inference only portion of randomized graph nodes and edges.
</p>
<p>
In general, any neural network can be defined or interpreted as graph network or a complete graph. The key of graph network is that each node in the graph  \(N_{u} \in G\) is iteratively update their representation as a function of input vector  \(x_{u}\) is edges features and connected node features. It update by accumulating information from their local neighbors which is done by message passing layers. Another key of graph network is the permutation-invariant of all reduce operation which aggregate information from their neighborhood. In other word, altering the graph node  \(N_{u}\) and edges  \(E_{u} \in G\) do not alter the final output of the reduce operation or their next interating operation. For example, PROD, SUM and MAX are permutation-invariant or we can say that  \(y( PX) =y( X)\) where  \(P\) is permutation matrix. Message passing neural networks formalism express the layers in graph network in general as the function  \(\Phi \) :\begin{equation}
h_{t+1}^{n} =\Phi \left( h_{t}^{n} ,\sum{}_{v\in N_{u}} \psi ( x_{u})\right)
\end{equation}
where   \(\sum \) is any permutation-invariant operate (not just SUM and depend on the desing approach) over all set of node  \(v\in N_{u}\).   \(\Phi \) in this case can be any differentiable function, e.g. dense layer or convolution and  \(\psi \) is message function, e.g. matrix multiplication. This is saying that the new representation of graph is a function of previous graph at time  \(t\) and masseges from local node  \(v\). This is one update on one node in graph and can be used for downstram task later on. For example in naive binary classification, the last output from graph node  \(n\) is computed as  \(x_{n} =\sigma \left( h_{t}^{n} \theta _{t} +b_{t}\right)\) and the binary ross entropy loss  \(L( x_{n})\) is computed. We can also view graph network like convolution on image which consider imediate local neighborhood of the pixel and downsampling it to some representation which is similar to how we view representation of graph node. (Yujia Li et al. 2015) introduced Gated GNNs combining gated recurrent unit GRU cell with GNNs. The state of the graph  \(h_{t}^{l+1}\) is interpreted as hidden states of GRU cell with learnable parameters  \(\lambda \), the update rule is 
\begin{equation}
h_{t+1}^{n} =\mathbb{GRU}\left( h_{t}^{n} ,\sum{}_{v\in N_{u}} \lambda h_{t}^{n}\right) \ 
\end{equation}In implementing the graph, we can use adjacency matrix  \(A\) is  \(n\) by  \(n\) matrix where  \(n\) is the number of node in the graph for example :

</p>
<p>
  <img src="image/graph.png" alt="lower bound", style="width:800px;height:100px;"></p>
<p>
Combine these together, we can summarize procedures as follow:
Concatenate the node state at time step \(t\) for node \(n_{0}\) to \(n_{k}\) we have matrix  \(H_{t}\) is \(N\) by \(D\) matrix, is the number of node and dimension of state respectively. We can compute matrix  \(R_{t}\) to be passed as an input to recurrent network or GRU as  \(R_{t} =\Sigma _{k} A\lambda _{k} H_{t}\) and that the next step of representation of the graph is  \(H_{t+1} =\mathbb{GRU}( H_{t} ,R_{t})\) or, in vanilla RNN is  \(H_{t+1} =\sigma ( UH_{t} +WR_{t})\) where  \(( U,\ W)\) is the parameters. In general, to use output from the graph we can either use one node classification:  \(Z_{i} =f\left( h_{t}^{i}\right)\) or graph classification:  \(Z_{G} =f\left( \Sigma _{i\in N_{u}} h_{t}^{i}\right)\) or link prediction:  \(Z_{i}{}_{j} =f\left( h_{t}^{i} ,h_{t}^{j} ,e_{ij}\right)\) where  \(h^{i}\) is connected to  \(h^{j}\) by edge  \(e_{ij}\). GraphSage (Hamilton et al. 2017) introduce ways to reduce computation in large graph network by subsampling neiborhood of the graph instead of inference full graph. Other than this, in gathering summation we can define weighting hyperparmeters  \(\alpha _{ij}\) taking acount for how other node is important, GCNs do this by using:
\begin{equation}
h_{t+1}^{n} =\Phi \left( h_{t}^{n} ,\sum{}_{v\in N_{u}} \alpha _{ij} \psi ( x_{u})\right)
\end{equation}GAT (Velickovic et al.) use this constant as function of graph nodes and their corresponding edges and is learnable:  \(\alpha _{ij} =\exp( \alpha _{ij}) /\Sigma _{v\in N_{u}} \alpha _{ij}\) is self-attention machanism. It is also obvious that the resulted matrix of  \(A\lambda _{k} H_{t}\), the output would potentially larger by layer. Mean-pooling normalize this by additionally mutiply degree matrix  \(D^{-1}\) of adjacency matrix  \(A\):  \(R_{t} =\Sigma _{k} D^{-1} A\lambda _{k} H_{t}\) where  \(D_{ii} =\Sigma _{j} A_{ij}\). Graph Convolution network (GCN Kipf and Welling 2017) use symmetric normalization as  \(H_{t+1} =\sigma \left( D^{-1/2} AD^{-1/2} H_{t} \lambda \right)\) can be written as
\begin{equation}
h_{t+1}^{n} =\sigma \left( h_{t}^{n} ,\sum{}_{v\in N_{u}} \lambda h_{t}^{n} /\sqrt{| N_{v}| | N_{n}| }\right) \ 
\end{equation}
Implementation can be found in my supplemental Github reprository given in the homepage.
</p>
</div>
          </div>

        </div><!--/blog_post--><!--/post_details-->

      </div>
    </section>
    
    
    <footer class="u-clearfix u-footer u-grey-80" id="sec-e381"><div class="u-clearfix u-sheet u-sheet-1">
        <div class="u-align-left u-social-icons u-spacing-10 u-social-icons-1">
          <a class="u-social-url" title="facebook" target="_blank" href="https://www.facebook.com/owan.naruemit"><span class="u-icon u-social-facebook u-social-icon u-icon-1"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-9909"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-9909"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M73.5,31.6h-9.1c-1.4,0-3.6,0.8-3.6,3.9v8.5h12.6L72,58.3H60.8v40.8H43.9V58.3h-8V43.9h8v-9.2
            c0-6.7,3.1-17,17-17h12.5v13.9H73.5z"></path></svg></span>
          </a>
          <a class="u-social-url" title="twitter" target="_blank" href="https://twitter.com/napanaruemit"><span class="u-icon u-social-icon u-social-twitter u-icon-2"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-d07a"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-d07a"><circle fill="currentColor" class="st0" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M83.8,47.3c0,0.6,0,1.2,0,1.7c0,17.7-13.5,38.2-38.2,38.2C38,87.2,31,85,25,81.2c1,0.1,2.1,0.2,3.2,0.2
            c6.3,0,12.1-2.1,16.7-5.7c-5.9-0.1-10.8-4-12.5-9.3c0.8,0.2,1.7,0.2,2.5,0.2c1.2,0,2.4-0.2,3.5-0.5c-6.1-1.2-10.8-6.7-10.8-13.1
            c0-0.1,0-0.1,0-0.2c1.8,1,3.9,1.6,6.1,1.7c-3.6-2.4-6-6.5-6-11.2c0-2.5,0.7-4.8,1.8-6.7c6.6,8.1,16.5,13.5,27.6,14
            c-0.2-1-0.3-2-0.3-3.1c0-7.4,6-13.4,13.4-13.4c3.9,0,7.3,1.6,9.8,4.2c3.1-0.6,5.9-1.7,8.5-3.3c-1,3.1-3.1,5.8-5.9,7.4
            c2.7-0.3,5.3-1,7.7-2.1C88.7,43,86.4,45.4,83.8,47.3z"></path></svg></span>
          </a>
          <a class="u-social-url" title="linkedin" target="_blank" href="https://www.linkedin.com/in/pethai-napanaruemit-3a69a7190/"><span class="u-icon u-social-icon u-social-linkedin u-icon-3"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-694a"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-694a"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M41.3,83.7H27.9V43.4h13.4V83.7z M34.6,37.9L34.6,37.9c-4.6,0-7.5-3.1-7.5-7c0-4,3-7,7.6-7s7.4,3,7.5,7
            C42.2,34.8,39.2,37.9,34.6,37.9z M89.6,83.7H76.2V62.2c0-5.4-1.9-9.1-6.8-9.1c-3.7,0-5.9,2.5-6.9,4.9c-0.4,0.9-0.4,2.1-0.4,3.3v22.5
            H48.7c0,0,0.2-36.5,0-40.3h13.4v5.7c1.8-2.7,5-6.7,12.1-6.7c8.8,0,15.4,5.8,15.4,18.1V83.7z"></path></svg></span>
          </a>
          <a class="u-social-url" target="_blank" data-type="Github" title="Github" href="https://github.com/pethai2004"><span class="u-icon u-social-github u-social-icon u-icon-4"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-a39c"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-a39c"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M88,51.3c0-5.5-1.9-10.2-5.3-13.7c0.6-1.3,2.3-6.5-0.5-13.5c0,0-4.2-1.4-14,5.3c-4.1-1.1-8.4-1.7-12.7-1.8
	c-4.3,0-8.7,0.6-12.7,1.8c-9.7-6.6-14-5.3-14-5.3c-2.8,7-1,12.2-0.5,13.5C25,41.2,23,45.7,23,51.3c0,19.6,11.9,23.9,23.3,25.2
	c-1.5,1.3-2.8,3.5-3.2,6.8c-3,1.3-10.2,3.6-14.9-4.3c0,0-2.7-4.9-7.8-5.3c0,0-5-0.1-0.4,3.1c0,0,3.3,1.6,5.6,7.5c0,0,3,9.1,17.2,6
	c0,4.3,0.1,8.3,0.1,9.5h25.2c0-1.7,0.1-7.2,0.1-14c0-4.7-1.7-7.9-3.4-9.4C76,75.2,88,70.9,88,51.3z"></path></svg></span>
          </a>
          <a class="u-social-url" target="_blank" data-type="YouTube" title="YouTube" href="https://www.youtube.com/channel/UCkQZQFB-PPBgNEL-GizSucw"><span class="u-icon u-social-icon u-social-youtube u-icon-5"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-7985"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-7985"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M74.9,33.3H37.3c-7.4,0-13.4,6-13.4,13.4v18.8c0,7.4,6,13.4,13.4,13.4h37.6c7.4,0,13.4-6,13.4-13.4V46.7 C88.3,39.3,82.3,33.3,74.9,33.3L74.9,33.3z M65.9,57l-17.6,8.4c-0.5,0.2-1-0.1-1-0.6V47.5c0-0.5,0.6-0.9,1-0.6l17.6,8.9 C66.4,56,66.4,56.8,65.9,57L65.9,57z"></path></svg></span>
          </a>
        </div>
        <div class="u-border-1 u-border-white u-expanded-width u-line u-line-horizontal u-opacity u-opacity-50 u-line-1"></div>
      </div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <a class="u-link" href="https://nicepage.com/website-templates" target="_blank">
        <span>Website Templates</span>
      </a>
      <p class="u-text">
        <span>created with</span>
      </p>
      <a class="u-link" href="" target="_blank">
        <span>Website Builder Software</span>
      </a>. 
    </section>
  
</body></html>